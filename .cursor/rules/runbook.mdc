---
description: "本地运行与常见操作手册"
---
# 本地运行与常见操作手册

本手册指导如何在本地环境部署和运行 XWall 系统。

## 1. 环境要求

- Python 3.9 或更高版本。

## 2. 安装步骤

首次运行时，启动脚本会自动处理大部分安装步骤。

### a. 创建虚拟环境与安装依赖

直接运行启动脚本即可自动创建虚拟环境并安装所需依赖。

- **Windows**:
  ```shell
  .\start.bat
  ```
- **Linux / macOS**:
  ```shell
  chmod +x start.sh
  ./start.sh
  ```

脚本会自动在项目根目录创建 `venv` 文件夹，并从 [`requirements.txt`](mdc:requirements.txt) 安装依赖包，同时会安装 Playwright 所需的浏览器核心。

### b. 手动安装 (可选)

如果你想手动进行安装：

1.  创建虚拟环境:
    ```shell
    python -m venv venv
    ```
2.  激活虚拟环境:
    - Windows: `.\venv\Scripts\activate`
    - Linux/macOS: `source venv/bin/activate`
3.  安装依赖:
    ```shell
    pip install -r requirements.txt
    playwright install chromium
    ```

## 3. 配置

1.  **主配置文件**:
    首次运行 [`start.sh`](mdc:start.sh) 时，系统会自动将 [`config/config.example.yaml`](mdc:config/config.example.yaml) 复制为 `config/config.yaml`。你需要根据自己的需求修改 `config/config.yaml` 文件中的配置项。
    对于 Windows 用户，需要手动复制并重命名该文件。

2.  **环境变量**:
    可以创建一个 `.env` 文件来配置环境变量，例如 `DEBUG` 或 `LOG_LEVEL`。[`start.sh`](mdc:start.sh) 支持通过 `-d` 或 `--debug` 参数来进入调试模式。

## 4. 运行系统

### a. 初始化数据库

如果 `data/xwall.db` 数据库文件不存在，启动脚本会自动初始化数据库。
你也可以手动或强制初始化数据库：

```shell
# 激活虚拟环境后运行
python cli.py db-init
```
或者通过启动脚本参数：
- Windows: `.\start.bat --init-db`
- Linux/macOS: `./start.sh --init-db`

### b. 启动主程序

配置完成后，再次运行启动脚本即可启动 XWall：

- **Windows**:
  ```shell
  .\start.bat
  ```
- **Linux / macOS**:
  ```shell
  ./start.sh
  ```
  
程序将通过 [`main.py`](mdc:main.py) 启动，并加载 FastAPI 服务。

## 5. 常见操作

- **强制重新初始化数据库**: `python cli.py db-init` (会清空现有数据)。
- **登录平台账号**:
  - Bilibili: 运行 [`bilibili_login_tool.py`](mdc:bilibili_login_tool.py)
  - 小红书: 运行 [`rednote_login_tool.py`](mdc:rednote_login_tool.py)
  - QQ空间: Cookies 需要手动获取并配置。


# 快速开始

## 系统要求

- **操作系统**: Windows 10+ / Linux / macOS
- **Python**: 3.9 或更高版本
- **内存**: 建议 4GB+
- **磁盘**: 至少 2GB 可用空间

## 一键安装与启动

### Windows 用户

1. **下载项目**
   ```powershell
   git clone https://github.com/lilingfeng/Graffito.git
   cd Graffito
   ```

2. **配置文件准备**
   ```powershell
   # 复制配置模板
   copy config\config.example.yaml config\config.yaml
   
   # 使用你喜欢的编辑器打开配置文件
   notepad config\config.yaml
   ```

3. **修改必要配置**
   
   至少需要配置以下项目：
   - `llm.api_key`: OpenAI API Key
   - `account_groups.default`: QQ账号和管理群信息
   
   详细配置说明见 [配置指南](./02-配置指南.md)

4. **启动系统**
   ```powershell
   # 双击运行，或在命令行执行
   start.bat
   ```

   首次运行会：
   - 自动创建虚拟环境
   - 安装所有依赖（包括 Playwright 浏览器）
   - 初始化数据库
   - 启动主程序

### Linux / macOS 用户

1. **下载项目**
   ```bash
   git clone https://github.com/lilingfeng/Graffito.git
   cd Graffito
   ```

2. **配置文件准备**
   ```bash
   # 复制配置模板
   cp config/config.example.yaml config/config.yaml
   
   # 编辑配置文件
   vim config/config.yaml  # 或使用 nano、gedit 等
   ```

3. **修改必要配置**（同 Windows）

4. **赋予执行权限并启动**
   ```bash
   chmod +x start.sh
   ./start.sh
   ```

## 前置准备

### 1. 获取 OpenAI API Key

系统使用 AI 处理投稿内容，需要 OpenAI API（或兼容的第三方服务）：

- **官方**: https://platform.openai.com/api-keys
- **国内中转**: 可使用支持 OpenAI 格式的代理服务

配置方式：
```yaml
llm:
  base_url: https://api.openai.com/v1  # 官方地址或代理地址
  api_key: sk-your-key-here
  text_model: gpt-4o-mini
  vision_model: gpt-4o-mini
```

### 2. 部署 QQ 机器人

推荐使用 [NapCat](https://github.com/NapNeko/NapCatQQ)：

1. **安装 NapCat**
   - 下载并安装 NapCat
   - 登录你的 QQ 机器人账号

2. **启用 HTTP 和 WebSocket 服务**
   
   在 NapCat 配置中：
   ```json
   {
     "http": {
       "enable": true,
       "host": "127.0.0.1",
       "port": 3000
     },
     "ws": {
       "enable": true,
       "host": "127.0.0.1",
       "port": 8082
     }
   }
   ```

3. **配置账号组**
   
   在 `config.yaml` 中：
   ```yaml
   account_groups:
     default:
       name: "默认组"
       manage_group_id: "123456789"  # 管理群QQ号
       main_account:
         qq_id: "987654321"          # 机器人QQ号
         http_host: "127.0.0.1"
         http_port: 3000
   ```

### 3. 配置反向 WebSocket（重要！）

Graffito 通过反向 WebSocket 接收 QQ 消息。在 `config.yaml` 中：

```yaml
server:
  host: "0.0.0.0"
  port: 8082  # 必须与 NapCat 的 ws.port 一致
```

确保 NapCat 的 WebSocket 反向地址指向 Graffito：
- 地址: `ws://127.0.0.1:8082/onebot/v11/ws`（如果在同一台机器）
- 地址: `ws://your_server_ip:8082/onebot/v11/ws`（如果分机部署）

## 启动检查

启动成功后，终端应显示：

```
╔═══════════════════════════════════════════╗
║               Graffito                    ║
║         校园墙自动运营系统                    ║
╚═══════════════════════════════════════════╝

```